#!/usr/bin/env bash

SCRIPT_DIRECTORY=$(cd `dirname $0` && pwd)
APP_ROOT="$SCRIPT_DIRECTORY"/..
BIN_DIR="$APP_ROOT"/bin

pushd "$APP_ROOT"/docker
docker-compose build
$BIN_DIR/run_docker bundle install
$BIN_DIR/run_docker bundle exec rake db:create
$BIN_DIR/run_docker bundle exec rake db:migrate
$BIN_DIR/run_docker bundle exec rake rswag:specs:swaggerize
$BIN_DIR/run_docker npm install
$BIN_DIR/run_docker npm run swagger2openapi
popd
